@model ACCDataStore.Web.Areas.SchoolProfile.ViewModels.Language.LanguageViewModel
@section Header {
    <link rel="stylesheet" href="~/Content/accdatastore/areas/nationality/views/nationality/nationality.css" type="text/css" />
    <link rel="stylesheet" href="//cdn.datatables.net/1.10.7/css/jquery.dataTables.css" type="text/css" />
    <script src="~/Scripts/accdatastore/areas/schoolprofile/views/Language/LevelOfEnglish.js"></script>
    <script type="text/javascript" src="http://code.highcharts.com/modules/exporting.js"></script>
    <script type="text/javascript" src="//cdn.datatables.net/1.10.7/js/jquery.dataTables.min.js"></script>

}
@{
    ViewBag.Title = "Index";
}
<h2>@Model.selectedschoolname</h2>

<h2>Level of English - Primary School (%pupils)</h2>
@if (Model.IsShowCriteria)
{
    using (Html.BeginForm("Index", "Language", new { area = "SchoolProfile" }))
    {
        <table>
            <tr>
                <th colspan="2">Please select Criteria</th>
            </tr>
            <tr>
                <td colspan="2">Select school name </td>
            </tr>
            <tr>
                <td></td>
                <td>@Html.DropDownListFor(x => x.selectedschoolname, new SelectList(Model.ListSchoolNameData), "---Please Select School---")</td>
                @*<td>@Html.DropDownList("selectSchoolname", new SelectList(Model.ListSchoolNameData, "----Select------"))</td>*@
            </tr>
            <tr>
                <td colspan="2">Select Gender </td>
            </tr>
            @foreach (var itemGender in Model.ListGenderCode)
            {
                if (Model.DicGenderWithSelected.ContainsKey(itemGender))
                {
                    <tr>
                        <td></td>
                        <td>
                            <input type="checkbox" name="gender" value="@itemGender"
                                   @Model.DicGenderWithSelected[itemGender][1] /> @Model.DicGenderWithSelected[itemGender][0]
                            </td>
                        </tr>
                }
            }
            <tr>
                <td></td>
                <td>
                    @{
            var check = "";
            if (Model.ListSelectedGender != null)
            {
                if (Model.ListSelectedGender.Count == 3)
                {
                    check = "checked";
                }

            }
            else
            {
                check = "checked";
            }
                    }
                    <input type="checkbox" name="CheckGenderAll" value="ALL" id="CheckGenderAll" @check />CheckALL

                </td>

            </tr>
            <tr>
                <td colspan="2">Select Level of English </td>
            </tr>
            @{

        foreach (var itemLevelEN in Model.ListLevelENCode)
        {
            check = "";
            if (Model.ListSelectedLevelENCode != null)
            {
                if (Model.ListSelectedLevelENCode.Contains(itemLevelEN))
                {
                    check = "checked";
                }

            }
            else
            {
                check = "checked";
            }

            if (Model.DicLevelEN.ContainsKey(itemLevelEN))
            {
                <tr>
                    <td></td>
                    <td>
                        <input type="checkbox" name="levelofen" value="@itemLevelEN"
                               @check /> @Model.DicLevelEN[itemLevelEN]
                        </td>
                    </tr>
            }
        }
            }
            <tr>
                <td></td>
                <td>
                    @{
        check = "";
        if (Model.ListSelectedLevelENCode != null)
        {
            if (Model.ListSelectedLevelENCode.Count == 8)
            {
                check = "checked";
            }

        }
        else
        {
            check = "checked";
        }
                    }

                    <input type="checkbox" name="CheckLevelENAll"
                           value="ALL" id="CheckLevelENAll" @check />CheckALL
                </td>

            </tr>
            <tr>
                <td>
                    <button id="buttonGetData" type="submit">
                        Get Data
                    </button>
                </td>
            </tr>


        </table>
    }
}
@if (Model.IsShowData)
{
    <br />
    <h2 style="text-align: center">@Model.selectedschoolname</h2>
    <h2 style="text-align: center">Level of English (%pupils)</h2>    
    <br />
    <form id="LevelENdata">
        <table id="datatable" class="display">
            <thead>
                <tr>
                    <th rowspan="2">Level of English</th>
                    @if (Model.ListSelectedGender != null && Model.ListSelectedGender.Count != 0)
                    {
                        foreach (var selection in Model.ListSelectedGender)
                        {
                            if (selection.Equals("F"))
                            {
                                <th colspan="2">Female</th>
                            }
                            if (selection.Equals("M"))
                            {
                                <th colspan="2">Male</th>
                            }
                            if (selection.Equals("T"))
                            {
                                <th colspan="2">Total</th>
                            }
                        }
                    }
                    <th rowspan="2">Select data </th>
                </tr>
                <tr>

                    @if (Model.ListSelectedGender != null && Model.ListSelectedGender.Count != 0)
                    {
                        foreach (var selection in Model.ListSelectedGender)
                        {
                            if (selection.Equals("F"))
                            {
                                <th>@Model.selectedschoolname</th>
                                <th>All Primary Schools</th>
                            }
                            if (selection.Equals("M"))
                            {
                                <th>@Model.selectedschoolname</th>
                                <th>All Primary Schools</th>
                            }
                            if (selection.Equals("T"))
                            {
                                <th>@Model.selectedschoolname</th>
                                <th>All Primary Schools</th>
                            }
                        }
                    }

                </tr>
            </thead>
            <tbody>
                @foreach (var itemEAL in Model.ListLevelENData)
                {

                    <tr>
                        <td>@itemEAL.IdentityName</td>

                        @if (Model.ListSelectedGender != null && Model.ListSelectedGender.Count != 0)
                        {
                            foreach (var selection in Model.ListSelectedGender)
                            {
                                if (selection.Equals("F"))
                                {
                                    <td align="center">@String.Format("{0:#,0.00}", @itemEAL.PercentageFemaleInSchool)</td>
                                    <td align="center">@String.Format("{0:#,0.00}", @itemEAL.PercentageFemaleAllSchool)</td>
                                }
                                if (selection.Equals("M"))
                                {
                                    <td align="center">@String.Format("{0:#,0.00}", @itemEAL.PercentageMaleInSchool)</td>
                                    <td align="center">@String.Format("{0:#,0.00}", @itemEAL.PercentageMaleAllSchool)</td>
                                }
                                if (selection.Equals("T"))
                                {
                                    <td align="center">@String.Format("{0:#,0.00}", @itemEAL.PercentageInSchool)</td>
                                    <td align="center">@String.Format("{0:#,0.00}", @itemEAL.PercentageAllSchool)</td>
                                }
                            }
                        }

                        <td align="center"><input type='checkbox' name='CheckDataitem' value="@itemEAL.IdentityCode" checked="checked" /></td>
                    </tr>
                }
            </tbody>
            <tr>
                @{var colspan = (@Model.ListSelectedGender.Count * 2) + 1;}
                <td colspan=@colspan></td>
                <td align="center"><input type='checkbox' name='CheckDataitemAll' id='CheckDataitemAll' value="ALL" checked="checked" />CheckALL</td>
            </tr>
            <tr><td><button onclick='myFunctionBar()'><label>Bar Chart</label></button></td></tr>
            <tr><td><button onclick='myFunctionColumn()'><label>Column Chart</label></button></td></tr>
            <tr><td>@Html.ActionLink("Export Excel", "ExportExcel", "Language", new { Area = "SchoolProfile", sSchoolName = "" }, null)</td></tr>
        </table>
        <script type="text/javascript">
            // Put your javascript code here
            $('#datatable').DataTable({
                paging: false
            });
        </script>

        <div id="divChartContainer"></div>
        <p>
            Source: Pupil Census <br> *In 2011 the Scottish Government
            introduced a new code list for Ethnicity, hence the historic data is
            not comparable
        </p>
    </form>
}

